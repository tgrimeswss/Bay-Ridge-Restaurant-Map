function initMap(){var e=[{featureType:"water",stylers:[{color:"#000000"}]},{featureType:"administrative",elementType:"labels.text.stroke",stylers:[{color:"#ffffff"},{weight:6}]}];map=new google.maps.Map(document.getElementById("map"),{center:new google.maps.LatLng(40.6251388,-74.0282899),zoom:14,styles:e});var o=new google.maps.InfoWindow,t=(function(){for(var e=0;e<locations.length;e++){var i=locations[e].location,a=locations[e].title;marker=new google.maps.Marker({position:i,map:map,title:a,website:locations[e].website,imgs:locations[e].imgs,animation:google.maps.Animation.DROP,icon:"forkknife.png",id:e}),locations[e].marker=marker,ViewModel.markerArray()[e].marker=marker,marker.popInfoWindow=function(){t(this,o)},marker.addListener("click",function(){t(this,o),this.setAnimation(google.maps.Animation.DROP)}),markers.push(marker)}}(),function(e,o){function t(t,i){if(i==google.maps.StreetViewStatus.OK){console.log("Name: "+e.title+". GPS: "+e.position);var a=t.location.latLng,n=google.maps.geometry.spherical.computeHeading(a,e.position);o.setContent('<div style="text-align:center;"><h2>'+e.title+'</h2><div id="pano"></div><br><a href="'+e.website+'">Click here for the menu</a></div>');var r={position:a,pov:{heading:n,pitch:30}};new google.maps.StreetViewPanorama(document.getElementById("pano"),r)}else o.setContent("<div>"+e.title+"</div><div>No Street View Found</div>")}if(o.marker!=e){o.setContent(""),o.marker=e,o.addListener("closeclick",function(){o.marker=null});var i=new google.maps.StreetViewService,a=50;i.getPanoramaByLocation(e.position,a,t),o.open(map,e),map.panTo(e.position),map.setZoom(16),e.setAnimation(google.maps.Animation.DROP)}})}var map,markers=[],Location=function(e){this.title=e.title},ViewModel={markerArray:ko.observableArray(),query:ko.observable(""),search:function(e){ViewModel.markerArray.removeAll();for(var o in locations)locations[o].title.toLowerCase().indexOf(e.toLowerCase())>=0&&ViewModel.markerArray.push(locations[o])},makeLocations:function(e){var o=this;e.forEach(function(e){o.markerArray.push(new Location(e))})},goToLocation:function(e,o){e.marker.popInfoWindow()}};ViewModel.makeLocations(locations),ViewModel.query.subscribe(ViewModel.search),ko.applyBindings(ViewModel);
